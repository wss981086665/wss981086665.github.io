<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><meta name="author" content="南国猫觅海"><link rel="icon" href="/hexo.png"><title>南国猫觅海</title><meta name="description" content="Life = Coding; Enjoy Life == Enjoy Coding;"><link rel="alternate" type="application/rss+xml" title="南国猫觅海" href="/atom.xml"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/highlight.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class="container-fluid"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#main-navbar" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">南国猫觅海</a></div><div id="main-navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/">首页</a></li><li><a href="/tags/">标签</a></li><li><a href="/categories/算法/">算法</a></li><li><a href="/categories/Java/">Java</a></li><li><a href="/categories/Redis/">Redis</a></li><li><a href="/categories/MySQL/">MySQL</a></li><li><a href="/categories/Python/">Python</a></li><li><a href="/categories/Linux/">Linux</a></li><li><a href="/archives/">时间轴</a></li><li><a href="/about/">About</a></li></ul></div><div class="avatar-container"><div class="avatar-img-border"><a href="/"><img src="/avatar.jpg" class="avatar-img"></a></div></div></div></nav><header class="header-section"><div class="intro-header no-img"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><h1>MongoDB基础知识全网最全2</h1><p class="post-meta">Posted on 8月 8 2019 · <a href="/tags/MongoDB/" class="tag post-meta">MongoDB</a> · <a href="/tags/数据库/" class="tag post-meta">数据库</a></p></div></div></div></div></div></header><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role="main" class="blog-post"><h2 id="四、语法"><a href="#四、语法" class="headerlink" title="四、语法"></a>四、语法</h2><h3 id="1-向集合中插入20000个条数据"><a href="#1-向集合中插入20000个条数据" class="headerlink" title="1.向集合中插入20000个条数据"></a>1.向集合中插入20000个条数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 方法一:    耗时:7.2s    效率太差</span><br><span class="line">for(var i=1; i&lt;20000; i++)&#123;</span><br><span class="line">      db.collection.insert(&#123;num:i&#125;);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"># 方法二:    耗时0.4s   效率很好</span><br><span class="line">var arr = [];</span><br><span class="line">for(var i=1; i&lt;20000; i++)&#123;</span><br><span class="line">      arr.push(&#123;num:i&#125;);</span><br><span class="line">&#125; </span><br><span class="line">db.collection.insert(arr);</span><br></pre></td></tr></table></figure>
<h3 id="2-查询collection中num大于500的所有数据"><a href="#2-查询collection中num大于500的所有数据" class="headerlink" title="2.查询collection中num大于500的所有数据"></a>2.查询collection中num大于500的所有数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find(&#123;num:&#123;$gt:500&#125;&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="3-查询collection中num大于40-小于50的所有数据"><a href="#3-查询collection中num大于40-小于50的所有数据" class="headerlink" title="3.查询collection中num大于40,小于50的所有数据"></a>3.查询collection中num大于40,小于50的所有数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find(&#123;num:&#123;$gt:40,$lt:50&#125;&#125;);</span><br><span class="line"># 注意:开发中绝对不能使用无条件地查询</span><br></pre></td></tr></table></figure>
<h3 id="4-查询collection中前10条数据"><a href="#4-查询collection中前10条数据" class="headerlink" title="4.查询collection中前10条数据"></a>4.查询collection中前10条数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find().limit(10);         </span><br><span class="line"># limit()限制获取数据数量的上限</span><br></pre></td></tr></table></figure>
<h3 id="5-查询collection中第11到20条数据"><a href="#5-查询collection中第11到20条数据" class="headerlink" title="5.查询collection中第11到20条数据"></a>5.查询collection中第11到20条数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find().skip(10).limit(10);  </span><br><span class="line"># skip()跳过指定数量的数据</span><br><span class="line"># 注意:skip()与limit()位置可以颠倒,MongoDB会自动调整它们的顺序</span><br></pre></td></tr></table></figure>
<h3 id="6-查询工资-sal-小于1000或大于2500的员工"><a href="#6-查询工资-sal-小于1000或大于2500的员工" class="headerlink" title="6.查询工资(sal)小于1000或大于2500的员工"></a>6.查询工资(sal)小于1000或大于2500的员工</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find(&#123;$or:[&#123;sal:&#123;$lt:1000&#125;&#125;,&#123;sal:&#123;$gt:2500&#125;&#125;]&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="7-所有工资低于1000的员工加400元的工资"><a href="#7-所有工资低于1000的员工加400元的工资" class="headerlink" title="7.所有工资低于1000的员工加400元的工资"></a>7.所有工资低于1000的员工加400元的工资</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.updateMany(&#123;sal:&#123;$lt:1000&#125;&#125;,&#123;$inc:&#123;sal:400&#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="8-查询文档时-让查询结果按sal进行排序"><a href="#8-查询文档时-让查询结果按sal进行排序" class="headerlink" title="8.查询文档时,让查询结果按sal进行排序"></a>8.查询文档时,让查询结果按sal进行排序</h3><p>注: 默认情况根据_id进行排序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find(&#123;&#125;).sort(&#123;sal:1&#125;)          #1 代表升序, -1代表降序</span><br><span class="line"># 注意:如果对象中有两个字段,那么先根据第一个字段进行排序。</span><br><span class="line"># 如果遇到第一个字段相同的数据,再对这些数据进行第二个字段的排序</span><br></pre></td></tr></table></figure></p>
<h2 id="五、知识点"><a href="#五、知识点" class="headerlink" title="五、知识点"></a>五、知识点</h2><h3 id="1-文档之间的关系"><a href="#1-文档之间的关系" class="headerlink" title="1.文档之间的关系:"></a>1.文档之间的关系:</h3><blockquote>
<ul>
<li>一对一 (one to one)     夫妻</li>
<li>一对多/多对一 (one to many)/(many to one)     父母-孩子</li>
<li>多对多 (many to many)</li>
</ul>
</blockquote>
<h2 id="六、mongoose"><a href="#六、mongoose" class="headerlink" title="六、mongoose"></a>六、mongoose</h2><h3 id="1-Node-js中使用mongoose"><a href="#1-Node-js中使用mongoose" class="headerlink" title="1.Node.js中使用mongoose"></a>1.Node.js中使用mongoose</h3><h4 id="1-下载安装mongoose"><a href="#1-下载安装mongoose" class="headerlink" title="1.下载安装mongoose"></a>1.下载安装mongoose</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save mongoose</span><br></pre></td></tr></table></figure>
<h4 id="2-在项目中引入mongoose"><a href="#2-在项目中引入mongoose" class="headerlink" title="2.在项目中引入mongoose"></a>2.在项目中引入mongoose</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">"mongoose"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="3-连接MongoDB"><a href="#3-连接MongoDB" class="headerlink" title="3.连接MongoDB"></a>3.连接MongoDB</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mongoose.connect(<span class="string">"mongodb://数据库的ip地址:端口号/数据库名"</span>,&#123;<span class="attr">useNewUrlParser</span>:<span class="literal">true</span>&#125;)</span><br><span class="line">   注意:如果端口号是默认端口号(<span class="number">27017</span>),则可以省略端口号</span><br><span class="line">   — 监听MongoDB数据库的连接状态</span><br><span class="line">   — 在mongoose对象中,有一个属性叫做connection,该对象表示的就是数据库连接</span><br><span class="line">       通过监视该对象的状态,可以来监听数据库的连接与断开</span><br></pre></td></tr></table></figure>
<h4 id="4-断开MongoDB数据库连接"><a href="#4-断开MongoDB数据库连接" class="headerlink" title="4.断开MongoDB数据库连接"></a>4.断开MongoDB数据库连接</h4><p>注: 一般不需要调用<br>注: MongoDB数据库,一般情况下,只连接一次,连接一次以后,除非项目停止服务器关闭,否则连接一般不会断开<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mongoose.disconnect()</span><br><span class="line"><span class="comment">// 数据库连接成功的事件</span></span><br><span class="line">mongoose.connection.once(<span class="string">"open"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>))</span></span><br><span class="line"><span class="function">// 数据库断开的事件</span></span><br><span class="line"><span class="function"><span class="title">mongoose</span>.<span class="title">connection</span>.<span class="title">once</span>(<span class="params"><span class="string">"close"</span>,function(</span>))</span></span><br></pre></td></tr></table></figure></p>
<h3 id="2-mongoose之Model"><a href="#2-mongoose之Model" class="headerlink" title="2.mongoose之Model"></a>2.mongoose之Model</h3><p>设:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> StuModel = mongoose.model(<span class="string">"student"</span>,stuSchema);</span><br></pre></td></tr></table></figure></p>
<p>注意:<br>1.中括号表示可选,没有括号表示必填<br>2.Model和数据库中的集合一一对应<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Model.find([conditions],[projection],[options],[callback])</span><br><span class="line"><span class="comment">// conditions: 查询条件 </span></span><br><span class="line"><span class="comment">// projection: 投影,需要获取到的字段</span></span><br><span class="line"><span class="comment">// options: 查询选项(skip limit)    //第三个参数&#123;skip:3,limit:1&#125;</span></span><br><span class="line"><span class="comment">// callback: 回调函数</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li><strong>1.StuModel.find({},{name:1,_id:0 },function(err,docs){});</strong><br>  返回的是一个数组.docs为查询返回的数据</li>
<li><strong>2.StuModel.find({},”name -_id”,function(err,docs){});</strong><br>效果与1相同</li>
<li><strong>3.StuModel.findById(“id”,function(err){})</strong><br>返回的是一个对象</li>
<li><strong>4.StuModel.update(conditions,doc, [options], [callback])</strong></li>
<li><strong>5.StuModel.updateMany(conditions,doc, [options], [callback])</strong></li>
<li><strong>6.StuModel.updateOne(conditions,doc, [options], [callback])</strong></li>
<li><strong>7.StuModel.remove(conditions, [callback])</strong></li>
<li><strong>8.StuModel.deleteOne(conditions, [callback])</strong></li>
<li><strong>9.StuModel.deleteMany(conditions, [callback])</strong></li>
<li><strong>10.StuModel.count():</strong> 统计文档的数量<h3 id="3-mongoose之Document"><a href="#3-mongoose之Document" class="headerlink" title="3.mongoose之Document"></a>3.mongoose之Document</h3>注意:Document和集合中的文档一一对应,是Model的一个实例<h4 id="1-创建一个Document对象-Model实例"><a href="#1-创建一个Document对象-Model实例" class="headerlink" title="1.创建一个Document对象(Model实例)"></a>1.创建一个Document对象(Model实例)</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> StuModel(&#123;</span><br><span class="line">     name: <span class="string">"孙悟空"</span>,</span><br><span class="line">     age: <span class="number">19</span>,</span><br><span class="line">     gender: <span class="string">"male"</span>,</span><br><span class="line">     address: <span class="string">"花果山"</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="string">``</span><span class="string">`    </span></span><br><span class="line"><span class="string">#### 2.保存Document对象</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span> nosql</span><br><span class="line">Stu.save(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3-修改Document对象"><a href="#3-修改Document对象" class="headerlink" title="3.修改Document对象"></a>3.修改Document对象</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(1).doc.age = 18;</span><br><span class="line">    doc.save();</span><br><span class="line">(2).doc.update(&#123;$set:&#123;age:28&#125;&#125;,function(err)&#123;&#125;)</span><br><span class="line">(3).doc.set(&quot;name&quot;,&quot;孙悟空&quot;);</span><br></pre></td></tr></table></figure>
<h4 id="4-删除Document对象"><a href="#4-删除Document对象" class="headerlink" title="4.删除Document对象"></a>4.删除Document对象</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">doc.remove(function (err) &#123;&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="5-获取文档中指定的属性值"><a href="#5-获取文档中指定的属性值" class="headerlink" title="5.获取文档中指定的属性值"></a>5.获取文档中指定的属性值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(1).var demo = doc.get(“name”);</span><br><span class="line">(2).var demo = doc.name;</span><br></pre></td></tr></table></figure>
<h4 id="6-将Document对象转换为JSON数据"><a href="#6-将Document对象转换为JSON数据" class="headerlink" title="6.将Document对象转换为JSON数据"></a>6.将Document对象转换为JSON数据</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">doc.toJSON();</span><br></pre></td></tr></table></figure>
<h4 id="7-将Document对象转换为object数据"><a href="#7-将Document对象转换为object数据" class="headerlink" title="7.将Document对象转换为object数据"></a>7.将Document对象转换为object数据</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">doc.toObject();  </span><br><span class="line">//注意:转换为普通的js对象以后,所有的Document对象的方法或属性都没有用啦</span><br></pre></td></tr></table></figure>
<p><strong>文集推荐:</strong></p>
<blockquote>
<p><a href="https://www.jianshu.com/nb/35411761" target="_blank" rel="noopener">Java基础方法集1</a><br><a href="https://www.jianshu.com/nb/35412583" target="_blank" rel="noopener">Python基础知识完整版</a><br><a href="https://www.jianshu.com/nb/35490047" target="_blank" rel="noopener">Spring Boot学习笔记</a><br><a href="https://www.jianshu.com/nb/35411158" target="_blank" rel="noopener">Linux指令进阶</a><br><a href="https://www.jianshu.com/nb/35701647" target="_blank" rel="noopener">Java高并发编程</a><br><a href="https://www.jianshu.com/nb/36348245" target="_blank" rel="noopener">SpringMVC基础知识进阶</a><br><a href="https://www.jianshu.com/nb/36768953" target="_blank" rel="noopener">Mysql基础知识完整版</a><br><a href="https://www.jianshu.com/nb/36626677" target="_blank" rel="noopener">健康管理系统学习花絮(学习记录)</a><br><a href="https://www.jianshu.com/nb/36852271" target="_blank" rel="noopener">Node.js基础知识(随手笔记)</a><br><a href="https://www.jianshu.com/nb/36850994" target="_blank" rel="noopener">MongoDB基础知识</a><br><a href="https://www.jianshu.com/nb/36474207" target="_blank" rel="noopener">Dubbo学习笔记</a><br><a href="https://www.jianshu.com/nb/35411638" target="_blank" rel="noopener">Vue学习笔记(随手笔记)</a></p>
</blockquote>
<blockquote>
<p>声明：发表此文是出于传递更多信息之目的。若有来源标注错误或侵犯了您的合法权益，请作者持权属证明与本我们(QQ:981086665；邮箱:<a href="mailto:981086665@qq.com" target="_blank" rel="noopener">981086665@qq.com</a>)联系联系，我们将及时更正、删除，谢谢。</p>
</blockquote>
</article><ul class="pager blog-pager"><li class="next"><a href="/2019/08/08/MongoDB基础知识全网最全1/" data-toggle="tooltip" data-placement="top" title="MongoDB基础知识全网最全1">Artículo siguiente →</a></li></ul><div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div><script src="//img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"> </script><script>var cloudTieConfig = {
  url: document.location.href, 
  sourceId: "",
  productKey: "64d7f0abf9224be3bfdcc6cfb9b83fcf",
  target: "cloud-tie-wrapper"
};</script></div></div></div><footer><div class="container beautiful-jekyll-footer"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href="https://weibo.com/5530988695/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo" title="Weibo"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-weibo"></i></span></a></li><li><a href="https://github.com/wss981086665" title="GitHub"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-github"></i></span></a></li><li><a href="/atom.xml" title="RSS"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-rss"></i></span></a></li><li><a href="981086665@qq.com" title="Email me"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-envelope"></i></span></a></li></ul><p class="copyright text-muted">© 南国猫觅海 • 2019 • <a href="mailto:undefined"></a>
</p><p class="theme-by text-muted">Theme by
<a href="https://github.com/twoyao/beautiful-hexo">beautiful-hexo</a></p></div></div></div></footer><script src="//cdn.bootcss.com/jquery/1.11.2/jquery.min.js"></script><script src="//cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/js/main.js"></script><script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>