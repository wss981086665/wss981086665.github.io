<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="南国猫觅海的个人博客">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="https://wss981086665.github.com">
    <!--SEO-->

    <meta name="keywords" content="JavaEE,后端,Redis,Spring Boot">


    <meta name="description" content="五、Redis

开发中常用的缓存中间件: resdis、memcached、chcache
Spring Boot默认的缓存配置类为 SimpleCacheConfiguration
Redi...">



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">

    <!--Title-->


<title>Spring Boot学习笔记5(Redis) | 南国猫觅海的个人博客</title>


    <link rel="alternate" href="/atom.xml" title="南国猫觅海的个人博客" type="application/atom+xml">


    <link rel="icon" href="/websiteicon.png">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
		<script type="text/javascript">
			var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
		</script>
	</div>






    

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header" style="background-image:url(http://snippet.shenliyang.com/img/banner.jpg)">
    <div class="main-header-box">
        <a class="header-avatar" href="/" title="南国猫觅海">
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                <h2> 最怕一生碌碌无为-还说平凡难能可贵 </h2>
            
    	</div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="https://wss981086665.github.com">南国猫觅海的个人博客</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Java/"><i class="fa "></i>Java</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Python/"><i class="fa "></i>Python</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Spring-Boot/"><i class="fa "></i>Spring Boot</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/Linux/"><i class="fa "></i>Linux</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives/"><i class="fa "></i>时间轴</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/about/index.html"><i class="fa "></i>关于</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="Spring Boot学习笔记5(Redis)">
            
	            Spring Boot学习笔记5(Redis)
            
        </h1>
        <div class="post-meta">
    
        <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
            <a class="category-link" href="/categories/Spring-Boot/">Spring Boot</a>
        </span>
    

    
        <span class="fa-wrap">
            <i class="fa fa-tags"></i>
            <span class="tags-meta">
                
                    <a class="tag-link" href="/tags/JavaEE/">JavaEE</a> <a class="tag-link" href="/tags/Redis/">Redis</a> <a class="tag-link" href="/tags/Spring-Boot/">Spring Boot</a> <a class="tag-link" href="/tags/后端/">后端</a>
                
            </span>
        </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/05/04</span>
        </span>
        
    
</div>
            
            
    </div>
    
    <div class="post-body post-content">
        <h1 id="五、Redis"><a href="#五、Redis" class="headerlink" title="五、Redis"></a>五、Redis</h1><blockquote>
<ul>
<li>开发中常用的缓存中间件: <code>resdis</code>、<code>memcached</code>、<code>chcache</code></li>
<li>Spring Boot默认的缓存配置类为 <code>SimpleCacheConfiguration</code></li>
<li>Redis是一个开源的(BSD许可)的，内存中的数据结构存储系统，它可以用作数据库、缓存和消息中间件，这里我们使用的是它的缓存中间件的功能</li>
</ul>
</blockquote>
<h2 id="5-1-Redis常用指令"><a href="#5-1-Redis常用指令" class="headerlink" title="5.1.Redis常用指令"></a>5.1.Redis常用指令</h2><h3 id="5-1-1-基本操作"><a href="#5-1-1-基本操作" class="headerlink" title="5.1.1.基本操作"></a>5.1.1.基本操作</h3><p>Redis或者Spring Boot中的Key,通常都包含逻辑上的命名空间,用符号 ”:” 分开,比如spring:session:xxxxxx<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; *set: 可以添加/覆盖一个字符串或数字类型</span><br><span class="line">        例: set platform:info “simple infomation”</span><br><span class="line">&gt; *get: 获取对应key的值</span><br><span class="line">        例: get platform:info</span><br><span class="line">&gt; *mget: 获取多个key的值</span><br><span class="line">         例: mget platform:version platform:info</span><br><span class="line">&gt; *DECR/INCR: 数字类型数据自减和自增</span><br><span class="line">&gt; *DECRBY/INCRBY: 数字类型数据减去/增加某个指定的整数</span><br><span class="line">&gt; *INCRBYFLOAT: 数字增加一个浮点数,负数表示减去</span><br></pre></td></tr></table></figure></p>
<p>注:以上操作都具有原子性<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; *keys: 查询Redis中的key</span><br><span class="line">        例: platform:* :表示所有patform:开的key</span><br><span class="line">             *: 表示查询所有的key</span><br><span class="line">&gt; *exists: 判断Key是否存在</span><br><span class="line">        例: exists platform:info                 <span class="comment">//返回1表示存在,返回0表示不存在</span></span><br><span class="line">&gt; *del: 删除Key-value</span><br><span class="line">         例: del platform:info                  <span class="comment">//返回1表示删除成功,返回0表示失败</span></span><br><span class="line">&gt; *expire: 指定多少秒后Key-value自动删除</span><br><span class="line">         例: expire platform <span class="number">10</span></span><br><span class="line">&gt; *ttl: 查看Key的剩余存活时间</span><br><span class="line">         例: ttl platform</span><br></pre></td></tr></table></figure></p>
<h3 id="5-1-2-Redis-List"><a href="#5-1-2-Redis-List" class="headerlink" title="5.1.2.Redis List"></a>5.1.2.Redis List</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*rpush: 可以将多个值放入list尾部,也可以理解为放入右侧</span><br><span class="line">          rpush platform:history “<span class="number">2012</span>-<span class="number">1</span>-<span class="number">1</span>”  “<span class="number">2012</span>-<span class="number">3</span>-<span class="number">5</span>”</span><br><span class="line">*lpush: 与rpush相反</span><br><span class="line">          lpush platform:history “<span class="number">2011</span>-<span class="number">10</span>-<span class="number">22</span>”</span><br><span class="line">*lrange: 从左到右显示指定范围的序列</span><br><span class="line">          lrarge platform:history <span class="number">0</span> <span class="number">2</span></span><br><span class="line">*rpop: 从列表尾部取出一个元素</span><br><span class="line">*lpop: 取出列表的头一个元素</span><br><span class="line">*llen: 返回List的长度</span><br><span class="line">*blpop或者brpop: 在List为空的时候处于等待状态,知道列表有元素,或者指定的时间到期为止</span><br></pre></td></tr></table></figure>
<h3 id="5-1-3-Redis-Hash"><a href="#5-1-3-Redis-Hash" class="headerlink" title="5.1.3.Redis Hash"></a>5.1.3.Redis Hash</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">*hset key field value: 给指定的Key设置一个字段值,如果值已经存在,则覆盖,返回<span class="number">0</span>表示失败,返回<span class="number">1</span>表示成功</span><br><span class="line">         例: hset session:<span class="number">1</span>xac name xiandafu</span><br><span class="line">*hget key field: 获取指定Key的field字段的值,如果不存在返回nil</span><br><span class="line">*hexists key field: 判断指定的Key的field字段是否存在,返回<span class="number">1</span>存在,<span class="number">0</span>不存在</span><br><span class="line">*hkeys key: 返回指定Key所指定的hash所有的字段名</span><br><span class="line">*hgetall key: 返回所有的字段名和字段值</span><br><span class="line">*hdel key field [field]: 删除多个字段</span><br><span class="line">*hincby key field value: 对Key指定的Hash数据中的field的值增加整型value</span><br><span class="line">          例: hset website access <span class="number">0</span></span><br><span class="line">               hincrby website access <span class="number">1</span>         <span class="comment">//此时数据变为1</span></span><br><span class="line">*hincbyfloat key field value: 对Key指定Hash数据中的field的值进行增加浮点value</span><br></pre></td></tr></table></figure>
<h3 id="5-1-4-Set"><a href="#5-1-4-Set" class="headerlink" title="5.1.4.Set"></a>5.1.4.Set</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*sad key member [member ..]: 添加元素</span><br><span class="line">*srem key member [member ..]: 删除元素</span><br><span class="line">*smember key: 返回一个集合中的所有元素</span><br><span class="line">*sinter key1 key2: 返回两个集合共同的元素,key1和key2分别代表两个集合</span><br><span class="line">*sinterstore key1 key2 key3: 取key1和key2的交集,并存放到key3集合中</span><br><span class="line">*sunion key1 key2: 返回一个合并后的集合</span><br><span class="line">*sunionstore key1 key2 key3: 合并key1和key2集合,并存放到key3集合中</span><br></pre></td></tr></table></figure>
<h3 id="5-1-5-Pub-Sub"><a href="#5-1-5-Pub-Sub" class="headerlink" title="5.1.5.Pub/Sub"></a>5.1.5.Pub/Sub</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">*subscribe news: news表示一个频道</span><br><span class="line">       返回第一行固定为 subscribe,第二行固定为频道的名称,第三行表示总共有多少个订阅者</span><br><span class="line">*publish: 向终端发送一条信息</span><br><span class="line">       例: punlish news “hello”</span><br><span class="line">       注: redis-cli一旦使用subscribe,将一直等待频道的消息并输出,如果想使用redis-cli中的其他命令,就必须重新打开一个终端</span><br><span class="line">*psubscribe:  另一种订阅模式</span><br><span class="line">       例: news.*: 订阅所有news.开头的频道</span><br><span class="line">           <span class="keyword">new</span>-?: 可以订阅news-<span class="number">1</span>、news-<span class="number">2</span>等频道</span><br><span class="line">           news[<span class="number">123</span>]: 订阅news-<span class="number">1</span>、news-<span class="number">2</span>、news-<span class="number">3</span>频道</span><br></pre></td></tr></table></figure>
<h2 id="5-2-Spring-Boot集成Redis"><a href="#5-2-Spring-Boot集成Redis" class="headerlink" title="5.2.Spring Boot集成Redis"></a>5.2.Spring Boot集成Redis</h2><p>引入依赖<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置application.properties</span></span><br><span class="line"><span class="string">spring.redis.host</span> <span class="string">=</span> <span class="number">127.0</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line"><span class="string">spring.redis.password</span> <span class="string">=</span> <span class="number">123456</span></span><br><span class="line"><span class="string">spring.redis.port</span> <span class="string">=</span> <span class="number">6379</span></span><br><span class="line"><span class="comment">#最大连接数</span></span><br><span class="line"><span class="string">spring.redis.pool.max-active</span> <span class="string">=</span> <span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>实例:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> StringRedisTemplate redisClient;</span><br><span class="line">…</span><br><span class="line">redisClient.opsForValue().set(“testenv”,para);  <span class="comment">//para=”123”相当于set  testenv  “123”</span></span><br><span class="line">…</span><br></pre></td></tr></table></figure></p>
<h2 id="5-3-使用StringRedisTemplate"><a href="#5-3-使用StringRedisTemplate" class="headerlink" title="5.3.使用StringRedisTemplate"></a>5.3.使用StringRedisTemplate</h2><p>StringRedisTemplate继承于RedisTemplate</p>
<h3 id="5-3-1-opsFor"><a href="#5-3-1-opsFor" class="headerlink" title="5.3.1.opsFor"></a>5.3.1.opsFor</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">*opsForValue: 用来设置普通的Key-Value</span><br><span class="line">redisClient.opsForValue().set(“testenv”,”para”)   == set  testenv  para</span><br><span class="line">redisClient.opsForValue().get(“testenv”)   == get  testenv</span><br><span class="line">*opsForList: 用来操作List结构</span><br><span class="line">redisClient. opsForList ().leftPush(“platform:message”,”hello”)</span><br><span class="line">        == lpush platform:message hello</span><br><span class="line">opsForList提供了lefPush、leftPushAll、leftPop、rightPush、rightPushAll、rightPop等操作,也提供了range于size操作,用于查看List的长度</span><br><span class="line">*posForHash: 用来操作Hash数据结构</span><br><span class="line">          redisClient.opsForHash().put(“cache”,key,value)  == hset cache key value</span><br></pre></td></tr></table></figure>
<h3 id="5-3-2-绑定Key的操作"><a href="#5-3-2-绑定Key的操作" class="headerlink" title="5.3.2.绑定Key的操作"></a>5.3.2.绑定Key的操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">BoundListOperations operations = redisClient.boundListOps(“somekey”);</span><br><span class="line"><span class="comment">//此后的操作就不需要在提供key参数</span></span><br><span class="line">*boundValueOps  --&gt;  BoundValueOperations      <span class="comment">//value相关操作</span></span><br><span class="line">*boundListOps  --&gt;  BoundListOperations            <span class="comment">//List相关操作</span></span><br><span class="line">*boundHashOps  --&gt;  BoundHashOperations        <span class="comment">//Hash相关操作</span></span><br><span class="line">*boundSetOps  --&gt;  BoundSetOperations            <span class="comment">//Set相关操作</span></span><br><span class="line">*boundZSetOps  --&gt; ZSetOperations                  <span class="comment">//Sorted Set相关操作</span></span><br><span class="line">*boundGeoOps  --&gt;  BoundGeoOperations         <span class="comment">//Geo,地理信息相关操作</span></span><br></pre></td></tr></table></figure>
<h3 id="5-3-2-RedisConnection"><a href="#5-3-2-RedisConnection" class="headerlink" title="5.3.2.RedisConnection"></a>5.3.2.RedisConnection</h3><p>用于低级别API操作Redis,具体实现有JRedis或者Lettuce</p>
<h3 id="5-3-3-Pub-Sub"><a href="#5-3-3-Pub-Sub" class="headerlink" title="5.3.3.Pub/Sub"></a>5.3.3.Pub/Sub</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">*convertAndSend(): 发送一条消息</span><br><span class="line">*redisClient. convertAndSend(“news”,”hello,world”)</span><br><span class="line">*MessageListener的onMessage方法:订阅消息</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRedisChannelListener</span> <span class="keyword">implements</span> <span class="title">MessageListener</span></span>&#123;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Message message，<span class="keyword">byte</span>[] pattern)</span></span>&#123;</span><br><span class="line">           <span class="keyword">byte</span>[] channel = message.getChannel();</span><br><span class="line">           <span class="keyword">byte</span>[] bs = message.getBody();</span><br><span class="line">           <span class="keyword">try</span>&#123;</span><br><span class="line">                String content = <span class="keyword">new</span> String(bs,”UTF-<span class="number">8</span>”);</span><br><span class="line">                String p = <span class="keyword">new</span> String(channel,”UTF-<span class="number">8</span>”);</span><br><span class="line">                System.out.println(“get ”+content+” from”+p);</span><br><span class="line">           &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e)&#123;</span><br><span class="line">                e.printStachTrace();</span><br><span class="line">           &#125;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注:编写好MessageListener后,还需要添加一些固定的Java代码来设置监听器<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function">MesssageListenerAdapter <span class="title">listenerAdapter</span><span class="params">()</span></span>&#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">new</span> MessageListenerAdapter(<span class="keyword">new</span> MyRedisChannelListener());</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function">RedisMessageListenerContainer <span class="title">container</span><span class="params">(RedisConnectionFactory connectionFactory,MessageListenerAdapter listenerAdapter)</span></span>&#123;</span><br><span class="line">     redisMessageListenerContainer container = <span class="keyword">new</span> RedisMessageListenerContainer();</span><br><span class="line">     container.setConnectionFactory(connectionFactory);</span><br><span class="line">     container.addMessageListener(listenerAdapter,<span class="keyword">new</span> PatternTopic(“news.*”));</span><br><span class="line">     <span class="keyword">return</span> container;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="5-3-4-自定义RedisConfig示例"><a href="#5-3-4-自定义RedisConfig示例" class="headerlink" title="5.3.4 自定义RedisConfig示例:"></a>5.3.4 自定义RedisConfig示例:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用来自定义序列化器的类</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRedisConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 自定义序列化为json格式</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;Object,Employee&gt; <span class="title">empRedisTemplate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            RedisConnectionFactory redisConnectionFactory)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">        RedisTemplate&lt;Object, Employee&gt; template = <span class="keyword">new</span> RedisTemplate&lt;Object, Employee&gt;();</span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        Jackson2JsonRedisSerializer&lt;Employee&gt; ser = <span class="keyword">new</span> Jackson2JsonRedisSerializer&lt;Employee&gt;(Employee.class);</span><br><span class="line">        template.setDefaultSerializer(ser);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自定义CacheManager</span></span><br><span class="line">    <span class="comment">//CacheManagerCustomizers可以定制缓存的一些规则</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisCacheManager <span class="title">employeeCacheManager</span><span class="params">(RedisTemplate&lt;Object,Employee&gt; empRedisTemplate)</span></span>&#123;</span><br><span class="line">        RedisCacheManager cacheManager = <span class="keyword">new</span> RedisCacheManager(empRedisTemplate);</span><br><span class="line">        cacheManager.setUsePrefix(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> cacheManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-4-序列化策略"><a href="#5-4-序列化策略" class="headerlink" title="5.4.序列化策略"></a>5.4.序列化策略</h2><p>使用默认序列化策略<br>-(1).引入<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="meta">@Qualifier</span>(“redisTemplate”)</span><br><span class="line"><span class="keyword">private</span> RedisTemplate redisClient;</span><br></pre></td></tr></table></figure></p>
<p>-(2).新建可序列的对象<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span>&#123;</span><br><span class="line">     ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="5-5-自定义序列化策略"><a href="#5-5-自定义序列化策略" class="headerlink" title="5.5.自定义序列化策略"></a>5.5.自定义序列化策略</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义序列化为json格式</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> RedisTemplate&lt;Object,Employee&gt; <span class="title">empRedisTemplate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">     RedisConnectionFactory redisConnectionFactory)</span><span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">        </span><br><span class="line">     RedisTemplate&lt;Object, Employee&gt; template = <span class="keyword">new</span> RedisTemplate&lt;Object, Employee&gt;();</span><br><span class="line">     template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">     Jackson2JsonRedisSerializer&lt;Employee&gt; ser = <span class="keyword">new</span> Jackson2JsonRedisSerializer&lt;Employee&gt;(Employee.class);</span><br><span class="line">     template.setDefaultSerializer(ser);</span><br><span class="line">     <span class="keyword">return</span> template;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    </div>
    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href target="_blank">Snippet</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2019/05/04/Spring-Boot6-Cache/" class="pre-post btn btn-default" title="Spring Boot6(Cache)">
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">Spring Boot6(Cache)</span>
        </a>
    
    
        <a href="/2019/05/04/Spring-Boot学习笔记4-配置/" class="next-post btn btn-default" title="Spring Boot学习笔记4(配置)">
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">Spring Boot学习笔记4(配置)</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: 'xOKV9J4UeQAtVkvnJC7Kq2Jn-gzGzoHsz',
            appKey: 'erIpQac4azoCmgfBB7Dl9maa',
            placeholder: '说点什么吧',
            notify: false,
            verify: false,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#五、Redis"><span class="toc-text">五、Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-Redis常用指令"><span class="toc-text">5.1.Redis常用指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-1-基本操作"><span class="toc-text">5.1.1.基本操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-2-Redis-List"><span class="toc-text">5.1.2.Redis List</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-3-Redis-Hash"><span class="toc-text">5.1.3.Redis Hash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-4-Set"><span class="toc-text">5.1.4.Set</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-5-Pub-Sub"><span class="toc-text">5.1.5.Pub/Sub</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-Spring-Boot集成Redis"><span class="toc-text">5.2.Spring Boot集成Redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-使用StringRedisTemplate"><span class="toc-text">5.3.使用StringRedisTemplate</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-1-opsFor"><span class="toc-text">5.3.1.opsFor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-2-绑定Key的操作"><span class="toc-text">5.3.2.绑定Key的操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-2-RedisConnection"><span class="toc-text">5.3.2.RedisConnection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-3-Pub-Sub"><span class="toc-text">5.3.3.Pub/Sub</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-4-自定义RedisConfig示例"><span class="toc-text">5.3.4 自定义RedisConfig示例:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-序列化策略"><span class="toc-text">5.4.序列化策略</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-自定义序列化策略"><span class="toc-text">5.5.自定义序列化策略</span></a></li></ol></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
        访问量:
        <strong id="busuanzi_value_site_pv">
            <i class="fa fa-spinner fa-spin"></i>
        </strong>
        &nbsp; | &nbsp;
        访客数:
        <strong id="busuanzi_value_site_uv">
            <i class="fa fa-spinner fa-spin"></i>
        </strong>
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2017
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>




    <script src="/assets/tagcanvas.min.js?rev=2.9"></script>
    <script>
        var tagOption = {
            textColour: '#444', // 字体颜色
            outlineMethod: 'block', // 选中模式
            outlineColour: '#FFDAB9', // 选中模式的颜色
            interval: 30 || 30, // 动画帧之间的时间间隔，值越大，转动幅度越大
            textHeight: 13,
            outlineRadius: 3,
            freezeActive: true || '', // 选中的标签是否继续滚动
            frontSelect: true || '', // 不选标签云后部的标签
            initial: [0.1, -0.1],
            depth: 0.5,
            decel: 0.95,
            maxSpeed: 0.03,
            reverse: true || '', // 是否反向触发
            fadeIn: 500, // 进入动画时间
            wheelZoom: false || '' // 是否启用鼠标滚轮
        }
        TagCanvas.Start('tag-cloud-3d','',tagOption);
    </script>



    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>